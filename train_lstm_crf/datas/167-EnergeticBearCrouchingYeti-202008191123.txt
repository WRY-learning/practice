Energetic Bear/Crouching Yeti: attacks on servers Release_Time : 2018-04-23 Report_URL : https://securelist.com/energetic-bear-crouching-yeti/85345/ Energetic Bear/Crouching Yeti is a widely known APT group active since at least 2010 .		threatActor_name threatActor_name threatActor_name others others others others others others others others others others others others threatActor_name threatActor_name threatActor_name others others others others others others others others others others time others
The group tends to attack different companies with a strong focus on the energy and industrial sectors .		reference_word reference_word others others others others others others others others others others others industry others industry industry others
Companies attacked by Energetic Bear/Crouching Yeti are geographically distributed worldwide with a more obvious concentration in Europe and the US .		others others others threatActor_name threatActor_name threatActor_name others others others others others others others others others others location others others location others
In 2016-2017 , the number of attacks on companies in Turkey increased significantly .		others time others others others others others others others others location others others others
The main tactics of the group include sending phishing emails with malicious documents and infecting various servers .		others others others others reference_word reference_word others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
The group uses some of the infected servers for auxiliary purposes – to host tools and logs .		reference_word reference_word others others others others tool tool others others others others attack_goal attack_goal attack_goal attack_goal attack_goal others
Others are deliberately infected to use them in waterhole attacks in order to reach the group's main targets .		others others others others others others others others attack_activity attack_activity others others others others others others others others others others
Recent activity of the group against US organizations was discussed in a US-CERT advisory , which linked the actor to the Russian government , as well as an advisory by the UK National Cyber Security Centre .		others others others reference_word reference_word others location others others others others others security_team others others others others reference_word reference_word others others government government others others others others others others others others security_team security_team security_team security_team security_team others
This report by Kaspersky Lab ICS CERT presents information on identified servers that have been infected and used by the group .		others others others security_team security_team security_team security_team others others others others others others others others others others others others reference_word reference_word others
The report also includes the findings of an analysis of several webservers compromised by the Energetic Bear group during 2016 and in early 2017 .		others others others others others others others others others others others sub_activity sub_activity others others threatActor_name threatActor_name threatActor_name others time others others others time others
Victims of the threat actor's attacks were not limited to industrial companies .		others others others reference_word reference_word others others others others others others industry industry others
Compromised servers :  Russia Opposition political website Waterhole .		others others others location others others others attack_activity others
Russia Real estate agency Auxiliary ( collecting user data in the waterhole attack ) .		location industry industry others others others attack_goal attack_goal attack_goal others others attack_activity attack_activity others others
Russia Football club Waterhole .		location others others attack_activity others
Russia Developer and integrator of secure automation systems and IS consultant Waterhole .		location person others person others others others others others others person attack_activity others
Russia Developers of software and equipment Auxiliary ( collecting user data in the waterhole attack , tool hosting ) .		location person person person person person others others attack_goal attack_goal attack_goal others others attack_activity attack_activity others attack_goal attack_goal others others
Russia Investment website Auxiliary ( collecting user data in the waterhole attack ) .		location industry others others others attack_goal attack_goal attack_goal others others attack_activity attack_activity others others
Ukraine	Electric power sector company Waterhole .		location industry industry industry others attack_activity others
Ukraine	Bank Waterhole .		location industry attack_activity others
UK	Aerospace company Waterhole .		location industry others attack_activity others
Germany	Software developer and integrator Waterhole .		location person person others person attack_activity others
Germany	Unknown Auxiliary ( collecting user data in the waterhole attack ) .		location others others others attack_goal attack_goal attack_goal others others attack_activity attack_activity others others
Turkey	Oil and gas sector enterprise Waterhole .		location industry industry industry industry others attack_activity others
Turkey	Industrial group Waterhole .		location industry others attack_activity others
Turkey	Investment group Waterhole .		location industry others attack_activity others
Greece	Server of a university Auxiliary ( collecting user data in the waterhole attack ) .		location others others others others others others attack_goal attack_goal attack_goal others others attack_activity attack_activity others others
USA	Oil and gas sector enterprise Waterhole .		location industry industry industry industry others attack_activity others
Unknown	Affiliate network site Auxiliary ( collecting user data in the waterhole attack ) .		others others others others others others attack_goal attack_goal attack_goal others others attack_activity attack_activity others others
All waterhole servers are infected following the same pattern : injecting a link into a web page or JS file with the following file scheme : file://IP/filename.png .		others attack_activity others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others
The link is used to initiate a request for an image , as a result of which the user connects to the remote server over the SMB protocol .		tool tool others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others person person others others others others others others others protocol others others
In this attack type , the attackers' goal is to extract the following data from the session :  user IP user name domain name NTLM hash of the user's password .		others others others others others person person others others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others others others others protocol others others others others others others others
In the process of analyzing infected servers , numerous websites and servers were identified that the attackers had scanned with various tools , such as nmap , dirsearch , sqlmap , etc .		others others others others others others others others others others others others others others others person person others others others others others others others others tool others tool others tool others others others
Even though the scanned servers do not necessarily look like potential final victims , it is likely that the attackers scanned different resources to find a server that could be used to establish a foothold for hosting the attackers' tools and , subsequently , to develop the attack .		others others others others others others others others others others others others others others others others others others person person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others others others others others others others others others
Part of the sites scanned may have been of interest to the attackers as candidates for hosting waterhole resources .		others others others others others others others others others others others person person others others others others attack_activity others others
In some cases , the domains scanned were hosted on the same server , sometimes the attackers went through the list of possible domains matching a given IP .		others others others others others others others others others others others others others others others person person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
In most cases , multiple attempts to compromise a specific target were not identified - with the possible exception of sites on the Bump platform , flight tracker servers and servers of a Turkish hotel chain .		others others others others others others others others others others others others others others others others others others others others others others others tool tool others others others others others others others others company company company others
Curiously , the sites scanned included a web developer's website , kashey.ru , and resources links to which were found on this site .		others others others others others others person person person others others others domain others others others others others others others others others others others others
These may have been links to resources developed by the site's owner : www.esodedi.ru , www.i-stroy.ru , www.saledoor.ru .		others others others others others others others others others others person person person others domain others domain others domain others
In addition , a custom Python script named ftpChecker.py was found on one of the servers .		others others others others others tool tool others sample_name others others others others others others others others
The script was designed to check FTP hosts from an incoming list .		reference_word reference_word others others others others protocol others others others others others others
The following malicious php files were found in different directories in the nginx folder and in a working directory created by the attackers on an infected web servers :  ini.php wso shell+ mail f3e3e25a822012023c6e81b206711865 2016-07-01 15:57:38 28786bytes .		others others others tool tool others others others others others others others others others others others others others others others others person person others others others others others others sample_name sample_function sample_function sample_function md5 time time others others
mysql.php wso shell+ mail f3e3e25a822012023c6e81b206711865 2016-06-12 13:35:30 28786bytes .		sample_name sample_function sample_function sample_function md5 time time others others
opts.php wso shell c76470e85b7f3da46539b40e5c552712 2016-06-12 12:23:28 36623bytes .		sample_name sample_function sample_function md5 time time others others
error_log.php wso shell 155385cc19e3092765bcfed034b82ccb 2016-06-12 10:59:39 36636bytes .		sample_name sample_function sample_function md5 time time others others
code29.php web shell 1644af9b6424e8f58f39c7fa5e76de51 2016-06-12 11:10:40 10724bytes .		sample_name sample_function sample_function md5 time time others others
proxy87.php web shell 1644af9b6424e8f58f39c7fa5e76de51 2016-06-12 14:31:13 10724bytes .		sample_name sample_function sample_function md5 time time others others
theme.php wso shell 2292f5db385068e161ae277531b2e114 2017-05-16 17:33:02 133104bytes .		sample_name sample_function sample_function md5 time time others others
sma.php PHPMailer 7ec514bbdc6dd8f606f803d39af8883f 2017-05-19 13:53:53 14696bytes .		sample_name sample_function md5 time time others others
media.php wso shell 78c31eff38fdb72ea3b1800ea917940f 2017-04-17 15:58:41 1762986bytes .		sample_name sample_function sample_function md5 time time others others
In the table above :  Web shell is a script that allows remote administration of the machine .		others others others others others tool tool others others others others others function function function function function others
WSO is a popular web shell and file manager ( it stands for "Web Shell by Orb" ) that has the ability to masquerade as an error page containing a hidden login form .		tool others others others others others others others others others others others others others others others others others others others others others others others others function function function function function function function function function function others
It is available on GitHub : https://github.com/wso-shell/WSO .		others others others others others others url url url others
Two of the PHP scripts found , ini.php and mysql.php , contained a WSO shell concatenated with the following email spamming script : https://github.com/bediger4000/php-malware-analysis/tree/master/db-config.php .		others others others tool tool others others sample_name others sample_name others others others tool tool others others others others attack_activity attack_activity others others url_evil url_evil url_evil others
All the scripts found are obfuscated .		others others others others others others others
One of the web shells was found on the server under two different names ( proxy87.php and code29.php ) .		others others others tool tool others others others others others others others others others others sample_name others sample_name others others
It uses the eval function to execute a command sent via HTTP cookies or a POST request .		reference_word others others function function others sub_activity sub_activity sub_activity sub_activity sub_activity protocol sub_activity sub_activity sub_activity protocol sub_activity others
A modified sshd with a preinstalled backdoor was found in the process of analyzing the server .		others others tool others others others malware others others others others others others others others others others
Patches with some versions of backdoors for sshd that are similar to the backdoor found are available on GitHub , for example : https://github.com/jivoi/openssh-backdoor-kit .		others others others others others malware others tool others others others others others malware others others others others others others others others others url url url others
As a result of replacing the original sshd file with a modified one on the infected server , an attacker can use a 'master password' to get authorized on the remote server , while leaving minimal traces ( compared to an ordinary user connecting via ssh ) .		others others others others others others others tool tool others others others others others others others others others person person others others others others tool others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others others others others others others others others others others others others others protocol others others
In addition , the modified sshd logs all legitimate ssh connections ( this does not apply to the connection that uses the 'master password' ) , including connection times , account names and passwords .		others others others others others tool others others others protocol others others others others others others others others others others others others others tool others others others others others others others others others others others others
The log is encrypted and is located at /var/tmp/.pipe.sock .		others others others others others others others others string others
After gaining access to the server , the attackers installed the tools they needed at different times .		others others others others others others others person person sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
Specifically , the following commands for third-party installations were identified on one of the servers :  apt install traceroute apt-get install nmap apt-get install screen git clone https://github.com/sqlmapproject/sqlmap.git .		others others others others others others others others others others others others others others others others others others others others others tool others others others others others url url url others
Additionally , the attackers installed any packages and tools for Python they needed .		others others others others others others others others others others others others others others
The attackers checked the smbtrap log file on working days .		person person others others tool tool tool others others others others
In addition , in the process of performing the analysis , an active process was identified that exploited SQL injection and collected data from a database of one of the victims .		others others others others others others others others others others others others others others others others others sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity sub_activity others
The findings of the analysis of compromised servers and the attackers' activity on these servers are as follows :  With rare exceptions , the group's members get by with publicly available tools .		others others others others others others others others others person person others others others others others others others others others others others others others reference_word reference_word person person others others others others others others others
The use of publicly available utilities by the group to conduct its attacks renders the task of attack attribution without any additional group 'markers' very difficult .		others others others others others others others reference_word reference_word others others others others others others others others others others others others others others others others others others others
Potentially , any vulnerable server on the internet is of interest to the attackers when they want to establish a foothold in order to develop further attacks against target facilities .		others others others others others others others others others others others others person person others others others others sub_activity sub_activity sub_activity others others others attack_goal attack_goal attack_goal attack_goal attack_goal attack_goal others
In most cases that we have observed , the group performed tasks related to searching for vulnerabilities , gaining persistence on various hosts , and stealing authentication data .		others others others others others others others others reference_word reference_word others others others others sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity others others sub_activity sub_activity sub_activity others
The diversity of victims may indicate the diversity of the attackers' interests .		others others others others others others others others others person person others others others
It can be assumed with some degree of certainty that the group operates in the interests of or takes orders from customers that are external to it , performing initial data collection , the theft of authentication data and gaining persistence on resources that are suitable for the attack's further development .		others others others others others others others others others others reference_word reference_word others others others others others others others others others person others others others others others others sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity sub_activity others sub_activity sub_activity sub_activity sub_activity others others others others others others others others others others
Energetic Bear/Crouching Yeti : /usr/lib/libng/ftpChecker.py .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/bin/nmap/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/lib/libng/dirsearch/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/share/python2.7/dirsearch/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/lib/libng/SMBTrap/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/lib/libng/commix/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/lib/libng/subbrute-master/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/share/python2.7/sqlmap/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/lib/libng/sqlmap-dev/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/lib/libng/wpscan/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/share/python2.7/wpscan/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/share/python2.7/Sublist3r/ .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/share/python2.7/sma.php .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/share/python2.7/theme.php .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /root/theme.php .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /usr/lib/libng/media.php .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : /var/tmp/.pipe.sock .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : f3e3e25a822012023c6e81b206711865 .		threatActor_name threatActor_name threatActor_name others md5 others
Energetic Bear/Crouching Yeti : c76470e85b7f3da46539b40e5c552712 .		threatActor_name threatActor_name threatActor_name others md5 others
Energetic Bear/Crouching Yeti : 155385cc19e3092765bcfed034b82ccb .		threatActor_name threatActor_name threatActor_name others md5 others
Energetic Bear/Crouching Yeti : 1644af9b6424e8f58f39c7fa5e76de51 .		threatActor_name threatActor_name threatActor_name others md5 others
Energetic Bear/Crouching Yeti : 2292f5db385068e161ae277531b2e114 .		threatActor_name threatActor_name threatActor_name others md5 others
Energetic Bear/Crouching Yeti : 7ec514bbdc6dd8f606f803d39af8883f .		threatActor_name threatActor_name threatActor_name others md5 others
Energetic Bear/Crouching Yeti : 78c31eff38fdb72ea3b1800ea917940f .		threatActor_name threatActor_name threatActor_name others md5 others
Energetic Bear/Crouching Yeti : rule Backdoored_ssh .		threatActor_name threatActor_name threatActor_name others string string others
Energetic Bear/Crouching Yeti : $a1 = "OpenSSH" .		threatActor_name threatActor_name threatActor_name others string string string others string others others
Energetic Bear/Crouching Yeti : $a2 = "usage : ssh" .		threatActor_name threatActor_name threatActor_name others string string string others string string string others others
Energetic Bear/Crouching Yeti : $a3 = "HISTFILE" .		threatActor_name threatActor_name threatActor_name others string string string others string others others
Energetic Bear/Crouching Yeti : uint32 (0 ) == 0x464c457f and filesize<1000000 and all of ( $a* ) .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : cd /tmp .		threatActor_name threatActor_name threatActor_name others string string others
Energetic Bear/Crouching Yeti : workdir=428c5fcf495396df04a459e317b70ca2 .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : mkdir $workdir .		threatActor_name threatActor_name threatActor_name others string string string others
Energetic Bear/Crouching Yeti : cd $workdir .		threatActor_name threatActor_name threatActor_name others string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname smbtrap > find-smbtrap.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname dirsearch > find-dirsearch.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname nmap > find-nmap.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname wpscan > find-wpscan.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname sublist3r > find-sublist3r.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : dpkg -l | grep -E \ (impacket\|pcapy\|nmap\ ) > dpkg-grep.txt .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : cp /var/lib/dpkg/info/openssh-server.md5sums .#retrieve initial hash for sshd .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string others
Energetic Bear/Crouching Yeti : md5sum /usr/sbin/sshd > sshd.md5sum #calculate actual hash for sshd .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string others
Energetic Bear/Crouching Yeti : cd /tmp .		threatActor_name threatActor_name threatActor_name others string string others
Energetic Bear/Crouching Yeti : workdir=428c5fcf495396df04a459e317b70ca2 .		threatActor_name threatActor_name threatActor_name others string others
Energetic Bear/Crouching Yeti : mkdir $workdir .		threatActor_name threatActor_name threatActor_name others string string string others
Energetic Bear/Crouching Yeti : cd $workdir .		threatActor_name threatActor_name threatActor_name others string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname smbtrap > find-smbtrap.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname dirsearch > find-dirsearch.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname nmap > find-nmap.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname wpscan > find-wpscan.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : find / -type d -iname sublist3r > find-sublist3r.txt 2>/dev/null .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : rpm -qa | grep -E \ (impacket\|pcapy\|nmap\ ) > rpm-grep.txt .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : rpm -qa –dump | grep ssh > rpm-qa-dump.txt #retrieve initial hash for sshd .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : sha256sum /usr/sbin/sshd > sshd.sha256sum #calculate actual sha256 hash for sshd .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others
Energetic Bear/Crouching Yeti : md5sum /usr/sbin/sshd > sshd.md5sum #calculate actual md5 hash for sshd .		threatActor_name threatActor_name threatActor_name others string string string string string string string string string string string others